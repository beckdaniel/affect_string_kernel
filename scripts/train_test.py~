import numpy as np
import flakes
import GPy
import sys

def read_sents(sents_dir):
    X = []
    for i in range(500, 1001):
        sent_file = os.path.join(sents_dir, str(i) + '.emb')
        X.append(np.loadtxt(sent_file))
    return X

SENTS_DIR = sys.argv[1]
LABELS_FILE = sys.argv[2]

INSTANCES = 10
X = read_sents(SENTS_DIR)[:INSTANCES]
Y = np.loadtxt(LABELS_FILE)[:INSTANCES, -1]

sk = flakes.wrappers.gpy.GPyStringKernel()
sk.order_coefs = [1.0]
sk.decay = 0.1

m = GPy.models.GPRegression(inputs, labels, kernel=sk)
m.optimize(messages=True, max_iters=20)
result = m.predict(inputs)
print result
